$(window).ready(function(){var t=7,n=5,o=400,a=!1,e=-350,i=0,s=30,c=120,l={left:c*(t-1),top:0},u=["s","c","h","d"],r=["a","2","3","4","5","6","7","8","9","10","j","q","k"],f=[],h=[],d=[],p=[];function v(){var t=p.pop();-1!=t.col?C(t):g(t),m()}function m(){$("#cardsLeft").text(d.length)}function g(t){var n=x(t);n.find(".back").removeClass("shadow"),t.location="drawPile",t.col=-1,b(n,t.num),d.push(t),function(t){x(t).removeClass("flip")}(t),n.css("transform","translate(0px, 0px)")}function w(t){var n=x(t);t="drawPile"==t.location?d.pop():h[t.col].pop();p.push(t),t.location="discardPile",b(n,p.length),p.length>3?n.find(".back").removeClass("shadow"):n.find(".back").addClass("shadow"),m(),n.css("transform","translate("+l.left+"px, "+l.top+"px)")}function x(t){return $("#"+t.face+t.suit)}function C(t){var o=h[t.col],a=i+c*t.col,l=e+s*o.length,u=x(t);t.location="column",o.push(t),u.find(".back").addClass("shadow"),b(u,o.length+(n+1-t.col)*n),u.css("transform","translate("+a+"px, "+l+"px)"),m()}function P(t){a=!0,t>=0?function t(o,a){a<n?setTimeout(function(){var n=d.pop();n.col=o,T(n),C(n),t(o,++a)},75):P(--o)}(t,0):a=!1}function T(t){x(t).addClass("flip")}function b(t,n){t.css("z-index",n+100),setTimeout(function(){t.css("z-index",n)},o)}function k(t,n,o){this.suit=t,this.face=n,this.val=o,this.location="drawPile",this.num,this.col=-1}function y(){for(var n,o=0;n=u[o++];)for(var a,e=0;a=r[e++];){var i=new k(n,a,e);f.push(i),x(i).data("card",i)}G(),z(),P(t-1)}function D(){(a=!0,d.length<f.length)?(g(f[d.length]),setTimeout(D,0)):(a=!1,setTimeout(function(){z(),P(t-1)},o))}function z(){!function(t){var n=t.length;if(0==n)return!1;for(;--n;){var o=Math.floor(Math.random()*(n+1)),a=t[n],e=t[o];t[n]=e,t[o]=a}}(f),d=[];for(var t,n=0;t=f[n++];)t.num=n,t.col=-1,x(t).css("z-index",t.num),d.push(t)}function G(){h=[],p=[],d=[];for(var n=0;n<t;n++)h.push([])}function M(){p.length&&(v(),setTimeout(M,75))}$("#table").on("touchstart click",".card",function(t){t.stopPropagation(),t.preventDefault();var n=$(this).data("card");if(!n.busy&&!a)if(function(t){t.busy=!0,setTimeout(function(){t.busy=!1},o)}(n),"drawPile"==n.location)!function(t){T(t),setTimeout(function(){w(t)},200)}(n);else if("column"==n.location){var e=h[n.col],i=e[e.length-1];n.num==i.num&&function(t){if(p.length){var n=p[p.length-1];t.val!=n.val-1&&t.val!=n.val+1||w(t),$("#loopCards").hasClass("selected")&&(1==t.val&&n.val==r.length||t.val==r.length&&1==n.val)&&w(t)}}(n)}else"discardPile"==n.location&&v()}),$("#newGame").on("touchstart click",function(t){t.stopPropagation(),t.preventDefault(),!a&&confirm("You want to play a new game?")&&(G(),D())}),$("#loopCards").on("touchstart click",function(t){t.stopPropagation(),t.preventDefault(),$(this).toggleClass("selected")}),$("#restart").on("touchstart click",function(t){t.stopPropagation(),t.preventDefault(),!a&&confirm("Do you want to play this game again?")&&M()}),setTimeout(function(){$("#fountainTextG").fadeOut(1e3),$("#table").addClass("show"),setTimeout(y,1e3)},3e3)});