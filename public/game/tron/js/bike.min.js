var Bike=function(i,t,e){this.dir=e,this.turning=!1,this.board=i,this.alive=!0,this.opponent=null;var s=new Coord(t[0],t[1]);this.segments=[s]};Bike.DIFFS={N:new Coord(-1,0),E:new Coord(0,1),S:new Coord(1,0),W:new Coord(0,-1)},Bike.prototype.isOccupying=function(i){var t=!1;return this.segments.forEach(function(e){e.equals(i)&&(t=!0)}),t},Bike.prototype.head=function(){return this.segments[this.segments.length-1]},Bike.prototype.isValid=function(i){if(!this.board.validPosition(i))return!1;for(var t=0;t<this.segments.length-1;t++)if(this.segments[t].equals(i))return!1;return!this.opponent.isOccupying(i)},Bike.prototype.move=function(){var i=this.head().plus(Bike.DIFFS[this.dir]);this.segments.push(i),this.turning=!1,this.isValid(i)||(this.alive=!1)},Bike.prototype.turn=function(i){Bike.DIFFS[i].isOpposite(Bike.DIFFS[this.dir])||this.turning||(this.turning=!0,this.dir=i)},Bike.prototype.computerChangeDir=function(){for(var i,t=(i="N"===this.dir||"S"===this.dir?["W","E"]:["N","S"])[0],e=0,s=this.head().plus(Bike.DIFFS[t]);this.isValid(s);)e+=1,s=s.plus(Bike.DIFFS[t]);for(var r=i[1],n=0,o=this.head().plus(Bike.DIFFS[r]);this.isValid(o);)n+=1,o=o.plus(Bike.DIFFS[r]);this.dir=e>n?t:r},Bike.prototype.computerMove=function(){var i=this.head().plus(Bike.DIFFS[this.dir]);Math.random()>this.computerTurnFrequency()&&this.computerChangeDir(),this.isValid(i)?this.segments.push(i):(this.computerChangeDir(),i=this.head().plus(Bike.DIFFS[this.dir]),this.segments.push(i)),this.isValid(i)||(this.alive=!1)},Bike.prototype.computerTurnFrequency=function(){return 1===this.board.difficulty?.95:2===this.board.difficulty?.98:1};var Coord=Coord||{};