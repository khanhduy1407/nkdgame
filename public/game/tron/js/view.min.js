var View=function(e,i){this.$el=e,this.players=i,this.board=new Board(100,70),this.speed=window.speed?window.speed:35,this.setupGrid()};View.prototype.startGame=function(){this.intervalId=window.setInterval(this.step.bind(this),this.speed),$(window).on("keydown",this.handleKeyEvent.bind(this)),$(window).on("click",this.handleDifficultyChange.bind(this))},View.KEYS1={38:"N",39:"E",40:"S",37:"W"},View.KEYS2={87:"N",68:"E",83:"S",65:"W"},View.prototype.handleKeyEvent=function(e){View.KEYS1[e.keyCode]?this.board.player1.turn(View.KEYS1[e.keyCode]):2===this.players&&View.KEYS2[e.keyCode]&&this.board.player2.turn(View.KEYS2[e.keyCode])},View.prototype.handleDifficultyChange=function(e){var i=e.target.className;"easy"===i?($(".easy").css("color","red"),$(".medium").css("color","white"),$(".hard").css("color","white"),window.difficulty=1,window.speed=35):"medium"===i?($(".easy").css("color","white"),$(".medium").css("color","red"),$(".hard").css("color","white"),window.difficulty=2,window.speed=30):"hard"===i&&($(".easy").css("color","white"),$(".medium").css("color","white"),$(".hard").css("color","red"),window.difficulty=3,window.speed=25)},View.prototype.setupGrid=function(){for(var e="",i=0;i<this.board.dimY;i++){e+="<ul>";for(var t=0;t<this.board.dimX;t++)e+="<li></li>";e+="</ul>"}this.$el.html(e),this.$li=this.$el.find("li")},View.prototype.step=function(){this.board.player1.alive&&this.board.player2.alive?(this.board.player1.move(),2===this.players?this.board.player2.move():this.board.player2.computerMove(),this.render()):(window.clearInterval(this.intervalId),$("#replay").show(),2===this.players?"Player 1"===this.checkWinner()?($("#player1-win").show(),window.wins.blue++):($("#player2-win").show(),window.wins.red++):"Player 1"===this.checkWinner()?($("#you-win").show(),window.wins.blue++):($("#computer-win").show(),window.wins.red++),this.updateScore())},View.prototype.updateScore=function(){$(".red-wins").text(window.wins.red),$(".blue-wins").text(window.wins.blue)},View.prototype.render=function(){this.updateClasses(this.board.player1.segments,"player"),this.updateClasses(this.board.player2.segments,"player2")},View.prototype.updateClasses=function(e,i){var t=this;e.forEach(function(e){var s=e.i*t.board.dimX+e.j;t.$li.eq(s).addClass(i)})},View.prototype.checkWinner=function(){return this.board.player1.alive?"Player 1":"Player 2"};var Board=Board||{};var View=function(e,i){this.$el=e,this.players=i,this.board=new Board(100,70),this.speed=window.speed?window.speed:35,this.setupGrid()};View.prototype.startGame=function(){this.intervalId=window.setInterval(this.step.bind(this),this.speed),$(window).on("keydown",this.handleKeyEvent.bind(this)),$(window).on("click",this.handleDifficultyChange.bind(this))},View.KEYS1={38:"N",39:"E",40:"S",37:"W"},View.KEYS2={87:"N",68:"E",83:"S",65:"W"},View.prototype.handleKeyEvent=function(e){View.KEYS1[e.keyCode]?this.board.player1.turn(View.KEYS1[e.keyCode]):2===this.players&&View.KEYS2[e.keyCode]&&this.board.player2.turn(View.KEYS2[e.keyCode])},View.prototype.handleDifficultyChange=function(e){var i=e.target.className;"easy"===i?($(".easy").css("color","red"),$(".medium").css("color","white"),$(".hard").css("color","white"),window.difficulty=1,window.speed=35):"medium"===i?($(".easy").css("color","white"),$(".medium").css("color","red"),$(".hard").css("color","white"),window.difficulty=2,window.speed=30):"hard"===i&&($(".easy").css("color","white"),$(".medium").css("color","white"),$(".hard").css("color","red"),window.difficulty=3,window.speed=25)},View.prototype.setupGrid=function(){for(var e="",i=0;i<this.board.dimY;i++){e+="<ul>";for(var t=0;t<this.board.dimX;t++)e+="<li></li>";e+="</ul>"}this.$el.html(e),this.$li=this.$el.find("li")},View.prototype.step=function(){this.board.player1.alive&&this.board.player2.alive?(this.board.player1.move(),2===this.players?this.board.player2.move():this.board.player2.computerMove(),this.render()):(window.clearInterval(this.intervalId),$("#replay").show(),2===this.players?"Player 1"===this.checkWinner()?($("#player1-win").show(),window.wins.blue++):($("#player2-win").show(),window.wins.red++):"Player 1"===this.checkWinner()?($("#you-win").show(),window.wins.blue++):($("#computer-win").show(),window.wins.red++),this.updateScore())},View.prototype.updateScore=function(){$(".red-wins").text(window.wins.red),$(".blue-wins").text(window.wins.blue)},View.prototype.render=function(){this.updateClasses(this.board.player1.segments,"player"),this.updateClasses(this.board.player2.segments,"player2")},View.prototype.updateClasses=function(e,i){var t=this;e.forEach(function(e){var s=e.i*t.board.dimX+e.j;t.$li.eq(s).addClass(i)})},View.prototype.checkWinner=function(){return this.board.player1.alive?"Player 1":"Player 2"};var Board=Board||{};