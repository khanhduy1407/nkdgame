!function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return r(n||t)},l,l.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){CanvasRenderingContext2D.prototype.storeLoadedImage=function(t,e){this.images||(this.images={}),this.images[t]=e},CanvasRenderingContext2D.prototype.getLoadedImage=function(t){if(this.images[t])return this.images[t]},CanvasRenderingContext2D.prototype.followSprite=function(t){this.centralSprite=t},CanvasRenderingContext2D.prototype.getCentralPosition=function(){return{map:this.centralSprite.mapPosition,canvas:[Math.round(.5*this.canvas.width),Math.round(.5*this.canvas.height),0]}},CanvasRenderingContext2D.prototype.mapPositionToCanvasPosition=function(t){var e=this.getCentralPosition(),n=e.map,i=e.canvas,r=n[0]-t[0],o=n[1]-t[1];return[i[0]-r,i[1]-o]},CanvasRenderingContext2D.prototype.canvasPositionToMapPosition=function(t){var e=this.getCentralPosition(),n=e.map,i=e.canvas,r=i[0]-t[0],o=i[1]-t[1];return[n[0]-r,n[1]-o]},CanvasRenderingContext2D.prototype.getCentreOfViewport=function(){return(this.canvas.width/2).floor()},CanvasRenderingContext2D.prototype.getMiddleOfViewport=function(){return(this.canvas.height/2).floor()},CanvasRenderingContext2D.prototype.getBelowViewport=function(){return this.canvas.height.floor()},CanvasRenderingContext2D.prototype.getMapBelowViewport=function(){var t=this.getBelowViewport();return this.canvasPositionToMapPosition([0,t])[1]},CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfCanvas=function(t){var e=0,n=this.canvas.width;return t&&(e-=t,n+=t),Number.random(e,n)},CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfMap=function(t){var e=this.getRandomlyInTheCentreOfCanvas(t);return this.canvasPositionToMapPosition([e,0])[0]},CanvasRenderingContext2D.prototype.getRandomMapPositionBelowViewport=function(){var t=this.getRandomlyInTheCentreOfCanvas(),e=this.getBelowViewport();return this.canvasPositionToMapPosition([t,e])},CanvasRenderingContext2D.prototype.getRandomMapPositionAboveViewport=function(){var t=this.getRandomlyInTheCentreOfCanvas(),e=this.getAboveViewport();return this.canvasPositionToMapPosition([t,e])},CanvasRenderingContext2D.prototype.getTopOfViewport=function(){return this.canvasPositionToMapPosition([0,0])[1]},CanvasRenderingContext2D.prototype.getAboveViewport=function(){return 0-(this.canvas.height/4).floor()}},{}],2:[function(t,e,n){Function.prototype.method=function(t,e){return this.prototype[t]=e,this},Object.method("superior",function(t){var e=this,n=e[t];return function(){return n.apply(e,arguments)}})},{}],3:[function(t,e,n){var i=t("./spriteArray"),r=t("eventedloop");!function(t){t.game=function(t,e){var n=new i,o=new i,s=new i,a=t.getContext("2d"),c=a.getCentreOfViewport(),u=0,l=!1,h=[],p=[],f=new r;this.addStaticObject=function(t){n.push(t)},this.addStaticObjects=function(t){t.forEach(this.addStaticObject.bind(this))},this.addMovingObject=function(t,e){e&&n.onPush(function(n){n.data&&n.data.hitBehaviour[e]&&n.onHitting(t,n.data.hitBehaviour[e])},!0),o.push(t)},this.addUIElement=function(t){s.push(t)},this.beforeCycle=function(t){h.push(t)},this.afterCycle=function(t){p.push(t)},this.setMouseX=function(t){c=t},this.setMouseY=function(t){u=t},e.setMapPosition(0,0),e.setMapPositionTarget(0,-10),a.followSprite(e),this.cycle=function(){h.each(function(t){t()});var t=a.canvasPositionToMapPosition([c,u]);e.isJumping||e.setMapPositionTarget(t[0],t[1]),e.cycle(),o.each(function(t,e){t.cycle(a)}),n.cull(),n.each(function(t,e){t.cycle&&t.cycle()}),s.each(function(t,e){t.cycle&&t.cycle()}),p.each(function(t){t()})},this.draw=function(){t.width=t.width,e.draw(a),e.cycle(),o.each(function(t,e){t.draw(a)}),n.each(function(t,e){t.draw&&t.draw(a,"main")}),s.each(function(t,e){t.draw&&t.draw(a,"main")})},this.start=function(){f.start()},this.pause=function(){l=!0,f.stop()},this.isPaused=function(){return l},this.reset=function(){l=!1,n=new i,o=new i,c=a.getCentreOfViewport(),u=0,e.reset(),e.setMapPosition(0,0,0),this.start()}.bind(this),f.on("20",this.cycle),f.on("20",this.draw)}}(this),void 0!==e&&(e.exports=this.game)},{"./spriteArray":12,eventedloop:16}],4:[function(t,e,n){!function(t){t.guid=function(){var t=function(){return Math.floor(65536*Math.random()).toString(16)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(this),void 0!==e&&(e.exports=this.guid)},{}],5:[function(t,e,n){void 0!==e&&(e.exports=function(t){var e=this;return e.lines=t.initialLines,e.top=t.position.top,e.right=t.position.right,e.bottom=t.position.bottom,e.left=t.position.left,e.width=t.width,e.height=t.height,e.setLines=function(t){e.lines=t},e.draw=function(t){t.font="11px monospace";var n=0;e.lines.each(function(i){var r,o,s=+t.font.slice(0,2),a=t.measureText(i).width,c=1.5*s;e.top?o=e.top+n:e.bottom&&(o=t.canvas.height-e.top-c+n),e.right?r=t.canvas.width-e.right-a:e.left&&(r=e.left),n+=c,t.fillText(i,r,o)})},e})},{}],6:[function(t,e,n){e.exports=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}},{}],7:[function(t,e,n){var i=t("./sprite");!function(t){t.monster=function(t){var e=new i(t),n=e.superior("draw"),r=1,o=0;return e.isEating=!1,e.isFull=!1,e.setSpeed(6),e.draw=function(t){var i;return n(t,(i=e.movingToward[0]-e.canvasX,e.isEating?"eating"+o:(r+.1>2?r=.1:r+=.1,i>=0?"sEast"+Math.ceil(r):i<0?"sWest"+Math.ceil(r):void 0)))},e.startEating=function t(n){o+=1,e.isEating=!0,e.isMoving=!1,o<6?setTimeout(function(){t(n)},300):(o=0,e.isEating=!1,e.isMoving=!0,n())},e}}(this),void 0!==e&&(e.exports=this.monster)},{"./sprite":11}],8:[function(t,e,n){!function(){for(var t,e=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=n.length,r=window.console=window.console||{};i--;)r[t=n[i]]||(r[t]=e)}()},{}],9:[function(t,e,n){var i=t("./sprite");"undefined"!=typeof navigator?navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate:navigator={vibrate:!1},function(t){t.skier=function(t){var e,n,r={west:270,wsWest:240,sWest:195,south:180,sEast:165,esEast:120,east:90},o=new i(t),s={draw:o.superior("draw"),cycle:o.superior("cycle"),getSpeedX:o.superior("getSpeedX"),getSpeedY:o.superior("getSpeedY"),hits:o.superior("hits")},a={esEast:function(t){return t>300},sEast:function(t){return t>75},wsWest:function(t){return t<-300},sWest:function(t){return t<-75}},c=!0,u=[],l=0,h=5,p=70,f=0,d=0,v=0,g=1,m=0;function E(){o.setSpeed(h),o.isMoving=!0,o.hasBeenHit=!1,o.isJumping=!1,o.isPerformingTrick=!1,n&&clearInterval(n),o.setMapPosition(void 0,void 0,0)}function y(){if(o.direction)return o.direction<=90?"east":o.direction>90&&o.direction<150?"esEast":o.direction>=150&&o.direction<180?"sEast":180===o.direction?"south":o.direction>180&&o.direction<=210?"sWest":o.direction>210&&o.direction<270?"wsWest":o.direction>=270?"west":"south";var t=o.movingToward[0]-o.mapPosition[0];return o.movingToward[1]-o.mapPosition[1]<=0?t>0?"east":"west":a.esEast(t)?"esEast":a.sEast(t)?"sEast":a.wsWest(t)?"wsWest":a.sWest(t)?"sWest":"south"}function w(t){r[t]&&o.setDirection(r[t]),o.isMoving="west"!==t&&"east"!==t}function T(t,e,n){return 0===n||1===n?e:(t<e&&(t+=o.getSpeed()*(n/p)),t>e&&(t-=o.getSpeed()*(n/p)),t)}return o.isMoving=!0,o.hasBeenHit=!1,o.isJumping=!1,o.isPerformingTrick=!1,o.onHitObstacleCb=function(){},o.setSpeed(h),o.reset=function(){u=[],l=0,o.isMoving=!0,o.hasBeenHit=!1,c=!0,E()},o.stop=function(){o.direction>180?w("west"):w("east")},o.turnEast=function(){switch(y()){case"west":w("wsWest");break;case"wsWest":w("sWest");break;case"sWest":w("south");break;case"south":w("sEast");break;case"sEast":w("esEast");break;case"esEast":w("east");break;default:w("south")}},o.turnWest=function(){switch(y()){case"east":w("esEast");break;case"esEast":w("sEast");break;case"sEast":w("south");break;case"south":w("sWest");break;case"sWest":w("wsWest");break;case"wsWest":w("west");break;default:w("south")}},o.stepWest=function(){o.mapPosition[0]-=2*o.speed},o.stepEast=function(){o.mapPosition[0]+=2*o.speed},o.setMapPositionTarget=function(t,e){o.hasBeenHit||(Math.abs(o.mapPosition[0]-t)<=75&&(t=o.mapPosition[0]),o.movingToward=[t,e])},o.startMovingIfPossible=function(){o.hasBeenHit||o.isBeingEaten||(o.isMoving=!0)},o.setTurnEaseCycles=function(t){p=t},o.getPixelsTravelledDownMountain=function(){return l},o.resetSpeed=function(){o.setSpeed(h)},o.cycle=function(){o.getSpeedX()<=0&&o.getSpeedY()<=0&&(o.isMoving=!1),o.isMoving&&(l+=o.speed),o.isJumping&&o.setMapPositionTarget(void 0,o.mapPosition[1]+o.getSpeed()),s.cycle(),o.checkHittableObjects()},o.draw=function(t){return s.draw(t,o.isBeingEaten?"blank":o.isJumping?o.isPerformingTrick?(console.log("Trick step is",m),0===m?"jumping":1===m?"somersault1":"somersault2"):"jumping":o.hasBeenHit?"hit":y())},o.hits=function(t){return-1===u.indexOf(t.id)&&!!t.occupiesZIndex(o.mapPosition[2])&&!!s.hits(t)},o.speedBoost=function(){var t=o.speed;c&&(c=!1,o.setSpeed(2*o.speed),setTimeout(function(){o.setSpeed(t),setTimeout(function(){c=!0},1e4)},2e3))},o.attemptTrick=function(){o.isJumping&&(o.isPerformingTrick=!0,n=setInterval(function(){m>=2?m=0:m+=1},300))},o.getStandardSpeed=function(){return h},o.getSpeedX=function(){return"esEast"===y()||"wsWest"===y()?(d=.5,f=T(f,o.getSpeed()*d,d)):"sEast"===y()||"sWest"===y()?(d=.33,f=T(f,o.getSpeed()*d,d)):f=T(f,0,d)},o.setSpeedY=function(t){v=t},o.getSpeedY=function(){return o.isJumping?v:"esEast"===y()||"wsWest"===y()?(g=.6,v=T(v,.6*o.getSpeed(),.6)):"sEast"===y()||"sWest"===y()?(g=.85,v=T(v,.85*o.getSpeed(),.85)):"east"===y()||"west"===y()?(g=1,v=0):v=T(v,o.getSpeed(),g)},o.hasHitObstacle=function(t){o.isMoving=!1,o.hasBeenHit=!0,o.isJumping=!1,o.isPerformingTrick=!1,n&&clearInterval(n),o.setMapPosition(void 0,void 0,0),navigator.vibrate&&navigator.vibrate(500),u.push(t.id),o.resetSpeed(),o.onHitObstacleCb(t),e&&clearTimeout(e),e=setTimeout(function(){E()},1500)},o.hasHitJump=function(){var t;t=o.getSpeed(),o.setSpeed(t+2),o.setSpeedY(t+2),o.isMoving=!0,o.hasBeenHit=!1,o.isJumping=!0,o.setMapPosition(void 0,void 0,1),e&&clearTimeout(e),e=setTimeout(function(){E()},1e3)},o.isEatenBy=function(t,e){o.hasHitObstacle(t),t.startEating(e),u.push(t.id),o.isMoving=!1,o.isBeingEaten=!0},o.reset=function(){u=[],l=0,o.isMoving=!0,o.isJumping=!1,o.hasBeenHit=!1,c=!0},o.setHitObstacleCb=function(t){o.onHitObstacleCb=t||function(){}},o}}(this),void 0!==e&&(e.exports=this.skier)},{"./sprite":11}],10:[function(t,e,n){var i=t("./sprite");!function(t){t.snowboarder=function(t){var e=new i(t),n={draw:e.superior("draw"),cycle:e.superior("cycle")},r={sEast:function(t){return t>0},sWest:function(t){return t<=0}};return e.setSpeed(3),e.cycle=function(t){1===Number.random(10)&&(e.setMapPositionTarget(t.getRandomlyInTheCentreOfMap()),e.setSpeed(3+Number.random(-1,1))),e.setMapPositionTarget(void 0,t.getMapBelowViewport()+600),n.cycle()},e.draw=function(t){var i;return n.draw(t,(i=e.movingToward[0]-e.mapPosition[0],e.movingToward[1],e.mapPosition[1],r.sEast(i)?"sEast":"sWest"))},e}}(this),void 0!==e&&(e.exports=this.snowboarder)},{"./sprite":11}],11:[function(t,e,n){!function(e){var n=t("./guid");function i(t){var e,i={},r=[0],o=this;function s(e){if(o.data.hitBoxes&&t.hitBoxes[e])return t.hitBoxes[e]}function a(t){return t=Math.round(2*t)/2}return o.direction=void 0,o.mapPosition=[0,0,0],o.id=n(),o.canvasX=0,o.canvasY=0,o.canvasZ=0,o.height=0,o.speed=0,o.data=t||{parts:{}},o.movingToward=[0,0],o.metresDownTheMountain=0,o.movingWithConviction=!1,o.deleted=!1,o.maxHeight=Object.values(o.data.parts).map(function(t){return t[3]}).max(),o.isMoving=!0,o.data.parts||(o.data.parts={}),t&&t.id&&(o.id=t.id),t&&t.zIndexesOccupied&&(r=t.zIndexesOccupied),this.draw=function(t,e){var n=o.data.parts[e];o.height=n[3],o.width=n[2];var i=t.mapPositionToCanvasPosition(o.mapPosition);o.setCanvasPosition(i[0],i[1]),t.drawImage(t.getLoadedImage(o.data.$imageFile),n[0],n[1],n[2],n[3],o.canvasX,o.canvasY,n[2],n[3])},this.setMapPosition=function(t,e,n){void 0===t&&(t=o.mapPosition[0]),void 0===e&&(e=o.mapPosition[1]),void 0===n?n=o.mapPosition[2]:o.zIndexesOccupied=[n],o.mapPosition=[t,e,n]},this.setCanvasPosition=function(t,e){var n;t&&(!Object.isString(t)||"+"!==t.first()&&"-"!==t.first()?o.canvasX=t:(n=t,o.canvasX+=n.toNumber())),e&&(!Object.isString(e)||"+"!==e.first()&&"-"!==e.first()?o.canvasY=e:function(t){o.canvasY+=t.toNumber()}(e))},this.getCanvasPositionX=function(){return o.canvasX},this.getCanvasPositionY=function(){return o.canvasY},this.getLeftHitBoxEdge=function(t){t=t||0;var e=this.getCanvasPositionX();return s(t)&&(e+=s(t)[0]),e},this.getTopHitBoxEdge=function(t){t=t||0;var e=this.getCanvasPositionY();return s(t)&&(e+=s(t)[1]),e},this.getRightHitBoxEdge=function(t){return s(t=t||0)?o.canvasX+s(t)[2]:o.canvasX+o.width},this.getBottomHitBoxEdge=function(t){return s(t=t||0)?o.canvasY+s(t)[3]:o.canvasY+o.height},this.getPositionInFrontOf=function(){return[o.canvasX,o.canvasY+o.height]},this.setSpeed=function(t){o.speed=t,o.speedX=t,o.speedY=t},this.incrementSpeedBy=function(t){o.speed+=t},o.getSpeed=function(){return o.speed},o.getSpeedX=function(){return o.speed},o.getSpeedY=function(){return o.speed},this.setHeight=function(t){o.height=t},this.setWidth=function(t){o.width=t},this.getMaxHeight=function(){return o.maxHeight},o.getMovingTowardOpposite=function(){if(!o.isMoving)return[0,0];var t=o.movingToward[0]-o.mapPosition[0],e=o.movingToward[1]-o.mapPosition[1];return[Math.abs(t)>75?0-t:0,-e]},this.checkHittableObjects=function(){Object.keys(i,function(t,e){e.object.deleted?delete i[t]:e.object.hits(o)&&e.callbacks.each(function(t){t(o,e.object)})})},this.cycle=function(){o.checkHittableObjects(),e&&o.setMapPositionTarget(e.mapPosition[0],e.mapPosition[1],!0),function(){if(o.isMoving){var t=o.mapPosition[0],e=o.mapPosition[1];if(void 0!==o.direction){var n=o.direction-90;n<0&&(n=360+n),t+=a(o.speed*Math.cos(n*(Math.PI/180))),e+=a(o.speed*Math.sin(n*(Math.PI/180)))}else void 0!==o.movingToward[0]&&(t>o.movingToward[0]?t-=Math.min(o.getSpeedX(),Math.abs(t-o.movingToward[0])):t<o.movingToward[0]&&(t+=Math.min(o.getSpeedX(),Math.abs(t-o.movingToward[0])))),void 0!==o.movingToward[1]&&(e>o.movingToward[1]?e-=Math.min(o.getSpeedY(),Math.abs(e-o.movingToward[1])):e<o.movingToward[1]&&(e+=Math.min(o.getSpeedY(),Math.abs(e-o.movingToward[1]))));o.setMapPosition(t,e)}}()},this.setMapPositionTarget=function(t,e,n){n&&(o.movingWithConviction=!1),o.movingWithConviction||(void 0===t&&(t=o.movingToward[0]),void 0===e&&(e=o.movingToward[1]),o.movingToward=[t,e],o.movingWithConviction=!1)},this.setDirection=function(t){t>=360&&(t=360-t),o.direction=t,o.movingToward=void 0},this.resetDirection=function(){o.direction=void 0},this.setMapPositionTargetWithConviction=function(t,e){o.setMapPositionTarget(t,e),o.movingWithConviction=!0},this.follow=function(t){e=t},this.stopFollowing=function(){e=!1},this.onHitting=function(t,e){if(i[t.id])return i[t.id].callbacks.push(e);i[t.id]={object:t,callbacks:[e]}},this.deleteOnNextCycle=function(){o.deleted=!0},this.occupiesZIndex=function(t){return r.indexOf(t)>=0},this.hits=function(t){var e=!1,n=!1;return t.getTopHitBoxEdge(o.mapPosition[2])<=o.getBottomHitBoxEdge(o.mapPosition[2])&&t.getBottomHitBoxEdge(o.mapPosition[2])>=o.getBottomHitBoxEdge(o.mapPosition[2])&&(e=!0),t.getTopHitBoxEdge(o.mapPosition[2])<=o.getTopHitBoxEdge(o.mapPosition[2])&&t.getBottomHitBoxEdge(o.mapPosition[2])>=o.getTopHitBoxEdge(o.mapPosition[2])&&(e=!0),t.getLeftHitBoxEdge(o.mapPosition[2])<=o.getRightHitBoxEdge(o.mapPosition[2])&&t.getRightHitBoxEdge(o.mapPosition[2])>=o.getRightHitBoxEdge(o.mapPosition[2])&&(n=!0),t.getLeftHitBoxEdge(o.mapPosition[2])<=o.getLeftHitBoxEdge(o.mapPosition[2])&&t.getRightHitBoxEdge(o.mapPosition[2])>=o.getLeftHitBoxEdge(o.mapPosition[2])&&(n=!0),e&&n},this.isAboveOnCanvas=function(t){return o.canvasY+o.height<t},this.isBelowOnCanvas=function(t){return o.canvasY>t},o}i.createObjects=function(t,e){return Array.isArray(t)||(t=[t]),e=Object.merge(e,{rateModifier:0,dropRate:1,position:[0,0]},!1,!1),t.map(function(t){var n=e.position;if(Number.random(100+e.rateModifier)<=t.dropRate){var r=new i(t.sprite);return r.setSpeed(0),Object.isFunction(n)&&(n=n()),r.setMapPosition(n[0],n[1]),t.sprite.hitBehaviour&&t.sprite.hitBehaviour.skier&&e.player&&r.onHitting(e.player,t.sprite.hitBehaviour.skier),r}}).remove(void 0)},e.sprite=i}(this),void 0!==e&&(e.exports=this.sprite)},{"./guid":4}],12:[function(t,e,n){!function(t){function e(){return this.pushHandlers=[],this}e.prototype=Object.create(Array.prototype),e.prototype.onPush=function(t,e){this.pushHandlers.push(t),e&&this.each(t)},e.prototype.push=function(t){Array.prototype.push.call(this,t),this.pushHandlers.each(function(e){e(t)})},e.prototype.cull=function(){this.each(function(t,e){if(t.deleted)return delete this[e]})},t.spriteArray=e}(this),void 0!==e&&(e.exports=this.spriteArray)},{}],13:[function(t,e,n){t("./lib/canvasRenderingContext2DExtensions"),t("./lib/extenders"),t("./lib/plugins");var i=t("hammerjs"),r=t("br-mousetrap"),o=t("./lib/isMobileDevice"),s=(t("./lib/spriteArray"),t("./lib/monster")),a=t("./lib/sprite"),c=t("./lib/snowboarder"),u=t("./lib/skier"),l=t("./lib/infoBox"),h=t("./lib/game"),p=document.getElementById("skifree-canvas"),f=p.getContext("2d"),d="Use the mouse or WASD keys to move the character";o()&&(d="Tap or drag on the line to control the character");var v=t("./spriteInfo"),g=18,m=0,E=2e3,y=5,w=0,T=!1,b={smallTree:4,tallTree:2,jump:1,thickSnow:1,rock:1};function _(t,e){e.isEatenBy(t,function(){y-=1,t.isFull=!0,t.isEating=!1,e.isBeingEaten=!1,t.setSpeed(e.getSpeed()),t.stopFollowing();var n=f.getRandomMapPositionAboveViewport();t.setMapPositionTarget(n[0],n[1])})}function x(){p.width=window.innerWidth,p.height=window.innerHeight}localStorage.getItem("highScore")&&(w=localStorage.getItem("highScore")),window.addEventListener("resize",x,!1),x(),function(t,e){var n=0,i={};function r(){(n+=1)===t.length&&e(i)}t.each(function(t){var e=new Image;e.onload=r,e.src=t,f.storeLoadedImage(t,e)})}(["sprite-characters.png","skifree-objects.png"],function(t){var e,n,o,x;function P(t,e){var n=Math.max(800-p.width,0);Number.random(1e3+n)<=e&&t()}function M(){var t=new s(v.monster),n=f.getRandomMapPositionAboveViewport();t.setMapPosition(n[0],n[1]),t.follow(e),t.setSpeed(e.getStandardSpeed()),t.onHitting(e,_),x.addMovingObject(t,"monster")}function S(){var t=new c(v.snowboarder),n=f.getRandomMapPositionAboveViewport(),i=f.getRandomMapPositionBelowViewport();t.setMapPosition(n[0],n[1]),t.setMapPositionTarget(i[0],i[1]),t.onHitting(e,v.snowboarder.hitBehaviour.skier),x.addMovingObject(t)}(e=new u(v.skier)).setMapPosition(0,0),e.setMapPositionTarget(0,-10),T&&e.setHitObstacleCb(function(){y-=1}),x=new h(p,e);var O=(new Date).getFullYear();n=new a(v.signStart),x.addStaticObject(n),n.setMapPosition(-50,0),f.followSprite(e),o=new l({initialLines:["Game: Skiing",d,"Number of lives remaining: "+y,"Gone 0m","The furthest distance: "+w+"m","Game created by NKDuy","© "+O+" NKDuy. All Rights Reserved."],position:{top:15,right:10}}),x.beforeCycle(function(){var t=[];e.isMoving&&(t=a.createObjects([{sprite:v.smallTree,dropRate:b.smallTree},{sprite:v.tallTree,dropRate:b.tallTree},{sprite:v.jump,dropRate:b.jump},{sprite:v.thickSnow,dropRate:b.thickSnow},{sprite:v.rock,dropRate:b.rock}],{rateModifier:Math.max(800-p.width,0),position:function(){return f.getRandomMapPositionBelowViewport()},player:e})),x.isPaused()||(x.addStaticObjects(t),P(S,.1),(m=parseFloat(e.getPixelsTravelledDownMountain()/g).toFixed(1))>E&&P(M,.001),o.setLines(["Game: Skiing",d,"Number of lives remaining: "+y,"Current speed: "+e.getSpeed()+"m/s","Gone "+m+"m","The furthest distance: "+w,"Game created by NKDuy","© "+O+" NKDuy. All Rights Reserved."]))}),x.afterCycle(function(){0===y&&(x.isPaused()||(w=localStorage.setItem("highScore",m),o.setLines(["Game over!",'Press "SPACE" to restart']),x.pause(),x.cycle()))}),x.addUIElement(o),$(p).mousemove(function(t){x.setMouseX(t.pageX),x.setMouseY(t.pageY),e.resetDirection(),e.startMovingIfPossible()}).bind("click",function(t){x.setMouseX(t.pageX),x.setMouseY(t.pageY),e.resetDirection(),e.startMovingIfPossible()}).focus(),r.bind("f",e.speedBoost),r.bind("t",e.attemptTrick),r.bind(["w","up"],function(){e.stop()}),r.bind(["a","left"],function(){270===e.direction?e.stepWest():e.turnWest()}),r.bind(["s","down"],function(){e.setDirection(180),e.startMovingIfPossible()}),r.bind(["d","right"],function(){90===e.direction?e.stepEast():e.turnEast()}),r.bind("m",M),r.bind("b",S),r.bind("space",function(){m=0,y=5,w=localStorage.getItem("highScore"),x.reset(),x.addStaticObject(n)}),i(p).on("press",function(t){t.preventDefault(),x.setMouseX(t.center.x),x.setMouseY(t.center.y)}).on("tap",function(t){x.setMouseX(t.center.x),x.setMouseY(t.center.y)}).on("pan",function(t){x.setMouseX(t.center.x),x.setMouseY(t.center.y),e.resetDirection(),e.startMovingIfPossible()}).on("doubletap",function(t){e.speedBoost()}),e.isMoving=!1,e.setDirection(270),x.start()}),this.exports=window},{"./lib/canvasRenderingContext2DExtensions":1,"./lib/extenders":2,"./lib/game":3,"./lib/infoBox":5,"./lib/isMobileDevice":6,"./lib/monster":7,"./lib/plugins":8,"./lib/skier":9,"./lib/snowboarder":10,"./lib/sprite":11,"./lib/spriteArray":12,"./spriteInfo":14,"br-mousetrap":15,hammerjs:18}],14:[function(t,e,n){!function(t){var e={skier:{$imageFile:"sprite-characters.png",parts:{blank:[0,0,0,0],east:[0,0,24,34],esEast:[24,0,24,34],sEast:[49,0,17,34],south:[65,0,17,34],sWest:[49,37,17,34],wsWest:[24,37,24,34],west:[0,37,24,34],hit:[0,78,31,31],jumping:[84,0,32,34],somersault1:[116,0,32,34],somersault2:[148,0,32,34]},hitBoxes:{0:[7,20,27,34]},id:"player",hitBehaviour:{}},smallTree:{$imageFile:"skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}},emptyChairLift:{$imageFile:"skifree-objects.png",parts:{main:[92,136,26,30]},zIndexesOccupied:[1]}};function n(t,e){e.deleteOnNextCycle()}function i(t,e){e.hasHitObstacle(t)}e.monster.hitBehaviour.tree=function(t){t.deleteOnNextCycle()},e.smallTree.hitBehaviour.monster=n,e.tallTree.hitBehaviour.monster=n,e.smallTree.hitBehaviour.skier=i,e.tallTree.hitBehaviour.skier=i,e.rock.hitBehaviour.skier=function(t,e){e.hasHitObstacle(t)},e.jump.hitBehaviour.skier=function(t,e){e.hasHitJump(t)},e.thickSnow.hitBehaviour.skier=function(t,e){e.setSpeed(2),setTimeout(function(){e.resetSpeed()},300)},e.snowboarder.hitBehaviour.skier=function(t,e){e.hasHitObstacle(t)},t.spriteInfo=e}(this),void 0!==e&&(e.exports=this.spriteInfo)},{}],15:[function(t,e,n){!function(){for(var t,n,i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},r={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc"},a={},c={},u={},l=!1,h=!1,p=1;p<20;++p)i[111+p]="f"+p;for(p=0;p<=9;++p)i[p+96]=p;function f(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function d(t){return"keypress"==t.type?String.fromCharCode(t.which):i[t.which]?i[t.which]:r[t.which]?r[t.which]:String.fromCharCode(t.which).toLowerCase()}function v(t){t=t||{};var e,n=!1;for(e in u)t[e]?n=!0:u[e]=0;n||(h=!1)}function g(t,e,n,i,r){var o,s,c,l,h=[],p=n.type;if(!a[t])return[];for("keyup"==p&&y(t)&&(e=[t]),o=0;o<a[t].length;++o)(s=a[t][o]).seq&&u[s.seq]!=s.level||p==s.action&&(("keypress"!=p||n.metaKey||n.ctrlKey)&&(c=e,l=s.modifiers,c.sort().join(",")!==l.sort().join(","))||(i&&s.combo==r&&a[t].splice(o,1),h.push(s)));return h}function m(t,e){!1===t(e)&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.returnValue=!1,e.cancelBubble=!0)}function E(t){t.which="number"==typeof t.which?t.which:t.keyCode;var e=d(t);e&&("keyup"!=t.type||l!=e?function(t,e){if(!_.stopCallback(e,e.target||e.srcElement)){var n,i=g(t,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(e),e),r={},o=!1;for(n=0;n<i.length;++n)i[n].seq?(o=!0,r[i[n].seq]=1,m(i[n].callback,e)):o||h||m(i[n].callback,e);e.type!=h||y(t)||v(r)}}(e,t):l=!1)}function y(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function w(e,n,r){return r||(r=function(){if(!t)for(var e in t={},i)e>95&&e<112||i.hasOwnProperty(e)&&(t[i[e]]=e);return t}()[e]?"keydown":"keypress"),"keypress"==r&&n.length&&(r="keydown"),r}function T(t,e,i,r){u[t]=0,r||(r=w(e[0],[]));var o,s=function(e){h=r,++u[t],clearTimeout(n),n=setTimeout(v,1e3)},a=function(t){m(i,t),"keyup"!==r&&(l=d(t)),setTimeout(v,10)};for(o=0;o<e.length;++o)b(e[o],o<e.length-1?s:a,r,t,o)}function b(t,e,n,i,r){var c,u,l,h=(t=t.replace(/\s+/g," ")).split(" "),p=[];if(h.length>1)T(t,h,e,n);else{for(l="+"===t?["+"]:t.split("+"),c=0;c<l.length;++c)u=l[c],s[u]&&(u=s[u]),n&&"keypress"!=n&&o[u]&&(u=o[u],p.push("shift")),y(u)&&p.push(u);n=w(u,p,n),a[u]||(a[u]=[]),g(u,p,{type:n},!i,t),a[u][i?"unshift":"push"]({callback:e,modifiers:p,action:n,seq:i,level:r,combo:t})}}f(document,"keypress",E),f(document,"keydown",E),f(document,"keyup",E);var _={bind:function(t,e,n){return function(t,e,n){for(var i=0;i<t.length;++i)b(t[i],e,n)}(t instanceof Array?t:[t],e,n),c[t+":"+n]=e,this},unbind:function(t,e){return c[t+":"+e]&&(delete c[t+":"+e],this.bind(t,function(){},e)),this},trigger:function(t,e){return c[t+":"+e](),this},reset:function(){return a={},c={},this},stopCallback:function(t,e){return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.contentEditable&&"true"==e.contentEditable)}};window.Mousetrap=_,"function"==typeof define&&define.amd&&define("mousetrap",function(){return _}),"object"==typeof e&&e.exports&&(e.exports=_)}()},{}],16:[function(t,e,n){(function(i){(function(){var r=this,o=t("events").EventEmitter,s=t("underscore"),a=/([0-9\.]+)(ms|s|m|h)?/;r=i||window;function c(t){var e=a.exec(t);if(!e)throw new Error("I don't understand that particular interval");var n=+e[1],i=e[2]||"ms";if("s"===i)n*=1e3;else if("m"===i)n=1e3*n*60;else if("h"===i)n=1e3*n*60*60;else if(i&&"ms"!==i)throw new Error("You can only specify intervals of ms, s, m, or h");if(n<10||n%10!=0)throw new Error("You can only specify 10s of milliseconds, trust me on this one");return{amount:n,type:i}}function u(){this.intervalId=void 0,this.intervalLength=void 0,this.intervalsToEmit={},this.currentTick=1,this.maxTicks=0,this.listeningForFocus=!1;var t=function(){var t=function(t){for(var e=1,n=s.min(t);0!==e;)0!==(e=s.reduce(t,function(t,e){return t+e%n},0))&&(n-=10);return n}(s.keys(this.intervalsToEmit)),e=!1;return this.intervalLength?t!==this.intervalLength&&(this.intervalLength=t,e=!0):this.intervalLength=t,this.maxTicks=s.max(s.map(s.keys(this.intervalsToEmit),function(t){return+t}))/this.intervalLength,e}.bind(this);this.on("newListener",function(e){if("removeListener"!==e&&"newListener"!==e){var n=c(e).amount;this.intervalsToEmit[+n]=s.union(this.intervalsToEmit[+n]||[],[e]),t()&&this.isStarted()&&this.stop().start()}}),this.on("removeListener",function(e){if(!(o.listenerCount(this,e)>0)){var n=c(e).amount,i=this.intervalsToEmit[+n].removeOne(e);0===this.intervalsToEmit[+n].length&&delete this.intervalsToEmit[+n],console.log("Determining interval length after removal of",i),t(),t()&&this.isStarted()&&this.stop().start()}})}void 0===Function.prototype.inherits&&(Function.prototype.inherits=function(t){this.prototype=Object.create(t.prototype)}),void 0===Array.prototype.removeOne&&(Array.prototype.removeOne=function(){for(var t,e,n=arguments,i=n.length;i&&this.length;)for(t=n[--i];-1!==(e=this.indexOf(t));)return this.splice(e,1)}),u.inherits(o),u.prototype.tick=function(){var t=this.currentTick*this.intervalLength;return s.each(this.intervalsToEmit,function(e,n){t%n==0&&s.each(e,function(t){this.emit(t,t,n)}.bind(this))}.bind(this)),this.currentTick+=1,this.currentTick>this.maxTicks&&(this.currentTick=1),this},u.prototype.start=function(){if(!this.intervalLength)throw new Error("You haven't specified any interval callbacks. Use EventedLoop.on('500ms', function () { ... }) to do so, and then you can start");return this.intervalId?console.log("No need to start the loop again, it's already started."):(this.intervalId=setInterval(this.tick.bind(this),this.intervalLength),r&&!this.listeningForFocus&&r.addEventListener&&(r.addEventListener("focus",function(){this.start()}.bind(this)),r.addEventListener("blur",function(){this.stop()}.bind(this)),this.listeningForFocus=!0),this)},u.prototype.stop=function(){return clearInterval(this.intervalId),this.intervalId=void 0,this},u.prototype.isStarted=function(){return!!this.intervalId},u.prototype.every=u.prototype.on,void 0!==n&&(void 0!==e&&e.exports&&(n=e.exports=u),n.EventedLoop=u),"undefined"!=typeof window&&(window.EventedLoop=u)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{events:19,underscore:17}],17:[function(t,e,n){(function(){var t=this,i=t._,r={},o=Array.prototype,s=Object.prototype,a=Function.prototype,c=o.push,u=o.slice,l=o.concat,h=s.toString,p=s.hasOwnProperty,f=o.forEach,d=o.map,v=o.reduce,g=o.reduceRight,m=o.filter,E=o.every,y=o.some,w=o.indexOf,T=o.lastIndexOf,b=Array.isArray,_=Object.keys,x=a.bind,P=function(t){return t instanceof P?t:this instanceof P?void(this._wrapped=t):new P(t)};void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=P),n._=P):t._=P,P.VERSION="1.6.0";var M=P.each=P.forEach=function(t,e,n){if(null==t)return t;if(f&&t.forEach===f)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,o=t.length;i<o;i++)if(e.call(n,t[i],i,t)===r)return}else{var s=P.keys(t);for(i=0,o=s.length;i<o;i++)if(e.call(n,t[s[i]],s[i],t)===r)return}return t};P.map=P.collect=function(t,e,n){var i=[];return null==t?i:d&&t.map===d?t.map(e,n):(M(t,function(t,r,o){i.push(e.call(n,t,r,o))}),i)};var S="Reduce of empty array with no initial value";P.reduce=P.foldl=P.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),v&&t.reduce===v)return i&&(e=P.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(M(t,function(t,o,s){r?n=e.call(i,n,t,o,s):(n=t,r=!0)}),!r)throw new TypeError(S);return n},P.reduceRight=P.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return i&&(e=P.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var s=P.keys(t);o=s.length}if(M(t,function(a,c,u){c=s?s[--o]:--o,r?n=e.call(i,n,t[c],c,u):(n=t[c],r=!0)}),!r)throw new TypeError(S);return n},P.find=P.detect=function(t,e,n){var i;return O(t,function(t,r,o){if(e.call(n,t,r,o))return i=t,!0}),i},P.filter=P.select=function(t,e,n){var i=[];return null==t?i:m&&t.filter===m?t.filter(e,n):(M(t,function(t,r,o){e.call(n,t,r,o)&&i.push(t)}),i)},P.reject=function(t,e,n){return P.filter(t,function(t,i,r){return!e.call(n,t,i,r)},n)},P.every=P.all=function(t,e,n){e||(e=P.identity);var i=!0;return null==t?i:E&&t.every===E?t.every(e,n):(M(t,function(t,o,s){if(!(i=i&&e.call(n,t,o,s)))return r}),!!i)};var O=P.some=P.any=function(t,e,n){e||(e=P.identity);var i=!1;return null==t?i:y&&t.some===y?t.some(e,n):(M(t,function(t,o,s){if(i||(i=e.call(n,t,o,s)))return r}),!!i)};P.contains=P.include=function(t,e){return null!=t&&(w&&t.indexOf===w?-1!=t.indexOf(e):O(t,function(t){return t===e}))},P.invoke=function(t,e){var n=u.call(arguments,2),i=P.isFunction(e);return P.map(t,function(t){return(i?e:t[e]).apply(t,n)})},P.pluck=function(t,e){return P.map(t,P.property(e))},P.where=function(t,e){return P.filter(t,P.matches(e))},P.findWhere=function(t,e){return P.find(t,P.matches(e))},P.max=function(t,e,n){if(!e&&P.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var i=-1/0,r=-1/0;return M(t,function(t,o,s){var a=e?e.call(n,t,o,s):t;a>r&&(i=t,r=a)}),i},P.min=function(t,e,n){if(!e&&P.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var i=1/0,r=1/0;return M(t,function(t,o,s){var a=e?e.call(n,t,o,s):t;a<r&&(i=t,r=a)}),i},P.shuffle=function(t){var e,n=0,i=[];return M(t,function(t){e=P.random(n++),i[n-1]=i[e],i[e]=t}),i},P.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=P.values(t)),t[P.random(t.length-1)]):P.shuffle(t).slice(0,Math.max(0,e))};var k=function(t){return null==t?P.identity:P.isFunction(t)?t:P.property(t)};P.sortBy=function(t,e,n){return e=k(e),P.pluck(P.map(t,function(t,i,r){return{value:t,index:i,criteria:e.call(n,t,i,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var N=function(t){return function(e,n,i){var r={};return n=k(n),M(e,function(o,s){var a=n.call(i,o,s,e);t(r,a,o)}),r}};P.groupBy=N(function(t,e,n){P.has(t,e)?t[e].push(n):t[e]=[n]}),P.indexBy=N(function(t,e,n){t[e]=n}),P.countBy=N(function(t,e){P.has(t,e)?t[e]++:t[e]=1}),P.sortedIndex=function(t,e,n,i){for(var r=(n=k(n)).call(i,e),o=0,s=t.length;o<s;){var a=o+s>>>1;n.call(i,t[a])<r?o=a+1:s=a}return o},P.toArray=function(t){return t?P.isArray(t)?u.call(t):t.length===+t.length?P.map(t,P.identity):P.values(t):[]},P.size=function(t){return null==t?0:t.length===+t.length?t.length:P.keys(t).length},P.first=P.head=P.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:e<0?[]:u.call(t,0,e)},P.initial=function(t,e,n){return u.call(t,0,t.length-(null==e||n?1:e))},P.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:u.call(t,Math.max(t.length-e,0))},P.rest=P.tail=P.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},P.compact=function(t){return P.filter(t,P.identity)};var C=function(t,e,n){return e&&P.every(t,P.isArray)?l.apply(n,t):(M(t,function(t){P.isArray(t)||P.isArguments(t)?e?c.apply(n,t):C(t,e,n):n.push(t)}),n)};P.flatten=function(t,e){return C(t,e,[])},P.without=function(t){return P.difference(t,u.call(arguments,1))},P.partition=function(t,e){var n=[],i=[];return M(t,function(t){(e(t)?n:i).push(t)}),[n,i]},P.uniq=P.unique=function(t,e,n,i){P.isFunction(e)&&(i=n,n=e,e=!1);var r=n?P.map(t,n,i):t,o=[],s=[];return M(r,function(n,i){(e?i&&s[s.length-1]===n:P.contains(s,n))||(s.push(n),o.push(t[i]))}),o},P.union=function(){return P.uniq(P.flatten(arguments,!0))},P.intersection=function(t){var e=u.call(arguments,1);return P.filter(P.uniq(t),function(t){return P.every(e,function(e){return P.contains(e,t)})})},P.difference=function(t){var e=l.apply(o,u.call(arguments,1));return P.filter(t,function(t){return!P.contains(e,t)})},P.zip=function(){for(var t=P.max(P.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;n<t;n++)e[n]=P.pluck(arguments,""+n);return e},P.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},P.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return t[i=P.sortedIndex(t,e)]===e?i:-1;i=n<0?Math.max(0,r+n):n}if(w&&t.indexOf===w)return t.indexOf(e,n);for(;i<r;i++)if(t[i]===e)return i;return-1},P.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(T&&t.lastIndexOf===T)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},P.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,o=new Array(i);r<i;)o[r++]=t,t+=n;return o};var D=function(){};P.bind=function(t,e){var n,i;if(x&&t.bind===x)return x.apply(t,u.call(arguments,1));if(!P.isFunction(t))throw new TypeError;return n=u.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(u.call(arguments)));D.prototype=t.prototype;var r=new D;D.prototype=null;var o=t.apply(r,n.concat(u.call(arguments)));return Object(o)===o?o:r}},P.partial=function(t){var e=u.call(arguments,1);return function(){for(var n=0,i=e.slice(),r=0,o=i.length;r<o;r++)i[r]===P&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},P.bindAll=function(t){var e=u.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return M(e,function(e){t[e]=P.bind(t[e],t)}),t},P.memoize=function(t,e){var n={};return e||(e=P.identity),function(){var i=e.apply(this,arguments);return P.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},P.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},P.defer=function(t){return P.delay.apply(P,[t,1].concat(u.call(arguments,1)))},P.throttle=function(t,e,n){var i,r,o,s=null,a=0;n||(n={});var c=function(){a=!1===n.leading?0:P.now(),s=null,o=t.apply(i,r),i=r=null};return function(){var u=P.now();a||!1!==n.leading||(a=u);var l=e-(u-a);return i=this,r=arguments,l<=0?(clearTimeout(s),s=null,a=u,o=t.apply(i,r),i=r=null):s||!1===n.trailing||(s=setTimeout(c,l)),o}},P.debounce=function(t,e,n){var i,r,o,s,a,c=function(){var u=P.now()-s;u<e?i=setTimeout(c,e-u):(i=null,n||(a=t.apply(o,r),o=r=null))};return function(){o=this,r=arguments,s=P.now();var u=n&&!i;return i||(i=setTimeout(c,e)),u&&(a=t.apply(o,r),o=r=null),a}},P.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},P.wrap=function(t,e){return P.partial(e,t)},P.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},P.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},P.keys=function(t){if(!P.isObject(t))return[];if(_)return _(t);var e=[];for(var n in t)P.has(t,n)&&e.push(n);return e},P.values=function(t){for(var e=P.keys(t),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},P.pairs=function(t){for(var e=P.keys(t),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},P.invert=function(t){for(var e={},n=P.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},P.functions=P.methods=function(t){var e=[];for(var n in t)P.isFunction(t[n])&&e.push(n);return e.sort()},P.extend=function(t){return M(u.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},P.pick=function(t){var e={},n=l.apply(o,u.call(arguments,1));return M(n,function(n){n in t&&(e[n]=t[n])}),e},P.omit=function(t){var e={},n=l.apply(o,u.call(arguments,1));for(var i in t)P.contains(n,i)||(e[i]=t[i]);return e},P.defaults=function(t){return M(u.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},P.clone=function(t){return P.isObject(t)?P.isArray(t)?t.slice():P.extend({},t):t},P.tap=function(t,e){return e(t),t};var I=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof P&&(t=t._wrapped),e instanceof P&&(e=e._wrapped);var r=h.call(t);if(r!=h.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return i[o]==e;var s=t.constructor,a=e.constructor;if(s!==a&&!(P.isFunction(s)&&s instanceof s&&P.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;n.push(t),i.push(e);var c=0,u=!0;if("[object Array]"==r){if(u=(c=t.length)==e.length)for(;c--&&(u=I(t[c],e[c],n,i)););}else{for(var l in t)if(P.has(t,l)&&(c++,!(u=P.has(e,l)&&I(t[l],e[l],n,i))))break;if(u){for(l in e)if(P.has(e,l)&&!c--)break;u=!c}}return n.pop(),i.pop(),u};P.isEqual=function(t,e){return I(t,e,[],[])},P.isEmpty=function(t){if(null==t)return!0;if(P.isArray(t)||P.isString(t))return 0===t.length;for(var e in t)if(P.has(t,e))return!1;return!0},P.isElement=function(t){return!(!t||1!==t.nodeType)},P.isArray=b||function(t){return"[object Array]"==h.call(t)},P.isObject=function(t){return t===Object(t)},M(["Arguments","Function","String","Number","Date","RegExp"],function(t){P["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),P.isArguments(arguments)||(P.isArguments=function(t){return!(!t||!P.has(t,"callee"))}),"function"!=typeof/./&&(P.isFunction=function(t){return"function"==typeof t}),P.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},P.isNaN=function(t){return P.isNumber(t)&&t!=+t},P.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==h.call(t)},P.isNull=function(t){return null===t},P.isUndefined=function(t){return void 0===t},P.has=function(t,e){return p.call(t,e)},P.noConflict=function(){return t._=i,this},P.identity=function(t){return t},P.constant=function(t){return function(){return t}},P.property=function(t){return function(e){return e[t]}},P.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},P.times=function(t,e,n){for(var i=Array(Math.max(0,t)),r=0;r<t;r++)i[r]=e.call(n,r);return i},P.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},P.now=Date.now||function(){return(new Date).getTime()};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};R.unescape=P.invert(R.escape);var B={escape:new RegExp("["+P.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+P.keys(R.unescape).join("|")+")","g")};P.each(["escape","unescape"],function(t){P[t]=function(e){return null==e?"":(""+e).replace(B[t],function(e){return R[t][e]})}}),P.result=function(t,e){if(null!=t){var n=t[e];return P.isFunction(n)?n.call(t):n}},P.mixin=function(t){M(P.functions(t),function(e){var n=P[e]=t[e];P.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),j.call(this,n.apply(P,t))}})};var A=0;P.uniqueId=function(t){var e=++A+"";return t?t+e:e},P.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;P.template=function(t,e,n){var i;n=P.defaults({},n,P.templateSettings);var r=new RegExp([(n.escape||V).source,(n.interpolate||V).source,(n.evaluate||V).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(r,function(e,n,i,r,a){return s+=t.slice(o,a).replace(H,function(t){return"\\"+L[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(s+="';\n"+r+"\n__p+='"),o=a+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(n.variable||"obj","_",s)}catch(t){throw t.source=s,t}if(e)return i(e,P);var a=function(t){return i.call(this,t,P)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},P.chain=function(t){return P(t).chain()};var j=function(t){return this._chain?P(t).chain():t};P.mixin(P),M(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];P.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],j.call(this,n)}}),M(["concat","join","slice"],function(t){var e=o[t];P.prototype[t]=function(){return j.call(this,e.apply(this._wrapped,arguments))}}),P.extend(P.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return P})}).call(this)},{}],18:[function(t,e,n){!function(t,n){"use strict";var i=function(t,e){return new i.Instance(t,e||{})};i.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},i.HAS_POINTEREVENTS=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,i.HAS_TOUCHEVENTS="ontouchstart"in t,i.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,i.NO_MOUSEEVENTS=i.HAS_TOUCHEVENTS&&t.navigator.userAgent.match(i.MOBILE_REGEX),i.EVENT_TYPES={},i.DIRECTION_DOWN="down",i.DIRECTION_LEFT="left",i.DIRECTION_UP="up",i.DIRECTION_RIGHT="right",i.POINTER_MOUSE="mouse",i.POINTER_TOUCH="touch",i.POINTER_PEN="pen",i.UPDATE_VELOCITY_INTERVAL=20,i.EVENT_START="start",i.EVENT_MOVE="move",i.EVENT_END="end",i.DOCUMENT=t.document,i.plugins=i.plugins||{},i.gestures=i.gestures||{},i.READY=!1,i.utils={extend:function(t,e,n){for(var i in e)void 0!==t[i]&&n||(t[i]=e[i]);return t},each:function(t,e,n){var i,r;if("forEach"in t)t.forEach(e,n);else if(void 0!==t.length){for(i=0,r=t.length;i<r;i++)if(!1===e.call(n,t[i],i,t))return}else for(i in t)if(t.hasOwnProperty(i)&&!1===e.call(n,t[i],i,t))return},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],n=[];return i.utils.each(t,function(t){e.push(void 0!==t.clientX?t.clientX:t.pageX),n.push(void 0!==t.clientY?t.clientY:t.pageY)}),{pageX:(Math.min.apply(Math,e)+Math.max.apply(Math,e))/2,pageY:(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2}},getVelocity:function(t,e,n){return{x:Math.abs(e/t)||0,y:Math.abs(n/t)||0}},getAngle:function(t,e){var n=e.pageY-t.pageY,i=e.pageX-t.pageX;return 180*Math.atan2(n,i)/Math.PI},getDirection:function(t,e){return Math.abs(t.pageX-e.pageX)>=Math.abs(t.pageY-e.pageY)?t.pageX-e.pageX>0?i.DIRECTION_LEFT:i.DIRECTION_RIGHT:t.pageY-e.pageY>0?i.DIRECTION_UP:i.DIRECTION_DOWN},getDistance:function(t,e){var n=e.pageX-t.pageX,i=e.pageY-t.pageY;return Math.sqrt(n*n+i*i)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==i.DIRECTION_UP||t==i.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(t,e){e&&t&&t.style&&(i.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(n){i.utils.each(e,function(e,i){n&&(i=n+i.substring(0,1).toUpperCase()+i.substring(1)),i in t.style&&(t.style[i]=e)})}),"none"==e.userSelect&&(t.onselectstart=function(){return!1}),"none"==e.userDrag&&(t.ondragstart=function(){return!1}))},startDefaultBrowserBehavior:function(t,e){e&&t&&t.style&&(i.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(n){i.utils.each(e,function(e,i){n&&(i=n+i.substring(0,1).toUpperCase()+i.substring(1)),i in t.style&&(t.style[i]="")})}),"none"==e.userSelect&&(t.onselectstart=null),"none"==e.userDrag&&(t.ondragstart=null))}},i.Instance=function(t,e){var n=this;return i.READY||(i.event.determineEventTypes(),i.utils.each(i.gestures,function(t){i.detection.register(t)}),i.event.onTouch(i.DOCUMENT,i.EVENT_MOVE,i.detection.detect),i.event.onTouch(i.DOCUMENT,i.EVENT_END,i.detection.detect),i.READY=!0),this.element=t,this.enabled=!0,this.options=i.utils.extend(i.utils.extend({},i.defaults),e||{}),this.options.stop_browser_behavior&&i.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),this._eventStartHandler=i.event.onTouch(t,i.EVENT_START,function(t){n.enabled&&i.detection.startDetect(n,t)}),this._eventHandler=[],this},i.Instance.prototype={on:function(t,e){var n=t.split(" ");return i.utils.each(n,function(t){this.element.addEventListener(t,e,!1),this._eventHandler.push({gesture:t,handler:e})},this),this},off:function(t,e){var n=t.split(" ");return i.utils.each(n,function(t){this.element.removeEventListener(t,e,!1);var n=-1;i.utils.each(this._eventHandler,function(i,r){-1===n&&i.gesture===t&&i.handler===e&&(n=r)},this),n>-1&&this._eventHandler.splice(n,1)},this),this},trigger:function(t,e){e||(e={});var n=i.DOCUMENT.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e;var r=this.element;return i.utils.hasParent(e.target,r)&&(r=e.target),r.dispatchEvent(n),this},enable:function(t){return this.enabled=t,this},dispose:function(){return this.options.stop_browser_behavior&&i.utils.startDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),i.utils.each(this._eventHandler,function(t){this.element.removeEventListener(t.gesture,t.handler,!1)},this),this._eventHandler.length=0,i.event.unbindDom(this.element,i.EVENT_TYPES[i.EVENT_START],this._eventStartHandler),this}};var r=null,o=!1,s=!1;i.event={bindDom:function(t,e,n){var r=e.split(" ");i.utils.each(r,function(e){t.addEventListener(e,n,!1)})},unbindDom:function(t,e,n){var r=e.split(" ");i.utils.each(r,function(e){t.removeEventListener(e,n,!1)})},onTouch:function(t,e,n){var a=this,c=function(c){var u=c.type.toLowerCase();if(!u.match(/mouse/)||!s){u.match(/touch/)||u.match(/pointerdown/)||u.match(/mouse/)&&1===c.which?o=!0:u.match(/mouse/)&&!c.which&&(o=!1),u.match(/touch|pointer/)&&(s=!0);var l=0;o&&(i.HAS_POINTEREVENTS&&e!=i.EVENT_END?l=i.PointerEvent.updatePointer(e,c):u.match(/touch/)?l=c.touches.length:s||(l=u.match(/up/)?0:1),l>0&&e==i.EVENT_END?e=i.EVENT_MOVE:l||(e=i.EVENT_END),(l||null===r)&&(r=c),n.call(i.detection,a.collectEventData(t,e,a.getTouchList(r,e),c)),i.HAS_POINTEREVENTS&&e==i.EVENT_END&&(l=i.PointerEvent.updatePointer(e,c))),l||(r=null,o=!1,s=!1,i.PointerEvent.reset())}};return this.bindDom(t,i.EVENT_TYPES[e],c),c},determineEventTypes:function(){var t;t=i.HAS_POINTEREVENTS?i.PointerEvent.getEvents():i.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],i.EVENT_TYPES[i.EVENT_START]=t[0],i.EVENT_TYPES[i.EVENT_MOVE]=t[1],i.EVENT_TYPES[i.EVENT_END]=t[2]},getTouchList:function(t){return i.HAS_POINTEREVENTS?i.PointerEvent.getTouchList():t.touches?t.touches:(t.identifier=1,[t])},collectEventData:function(t,e,n,r){var o=i.POINTER_TOUCH;return(r.type.match(/mouse/)||i.PointerEvent.matchType(i.POINTER_MOUSE,r))&&(o=i.POINTER_MOUSE),{center:i.utils.getCenter(n),timeStamp:(new Date).getTime(),target:r.target,touches:n,eventType:e,pointerType:o,srcEvent:r,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return i.detection.stopDetect()}}}},i.PointerEvent={pointers:{},getTouchList:function(){var t=[];return i.utils.each(this.pointers,function(e){t.push(e)}),t},updatePointer:function(t,e){return t==i.EVENT_END?delete this.pointers[e.pointerId]:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e),Object.keys(this.pointers).length},matchType:function(t,e){if(!e.pointerType)return!1;var n=e.pointerType,r={};return r[i.POINTER_MOUSE]=n===e.MSPOINTER_TYPE_MOUSE||n===i.POINTER_MOUSE,r[i.POINTER_TOUCH]=n===e.MSPOINTER_TYPE_TOUCH||n===i.POINTER_TOUCH,r[i.POINTER_PEN]=n===e.MSPOINTER_TYPE_PEN||n===i.POINTER_PEN,r[t]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},i.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:i.utils.extend({},e),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst.options;return i.utils.each(this.gestures,function(n){if(!this.stopped&&!1!==e[n.name]&&!1===n.handler.call(n,t,this.current.inst))return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=t),t.eventType==i.EVENT_END&&!t.touches.length-1&&this.stopDetect(),t}},stopDetect:function(){this.previous=i.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(t){var e=this.current.startEvent,n=this.current.lastVEvent;!e||t.touches.length==e.touches.length&&t.touches!==e.touches||(e.touches=[],i.utils.each(t.touches,function(t){e.touches.push(i.utils.extend({},t))}));var r,o,s=t.timeStamp-e.timeStamp,a=t.center.pageX-e.center.pageX,c=t.center.pageY-e.center.pageY,u=this.current.velocity;return!1!==n&&t.timeStamp-n.timeStamp>i.UPDATE_VELOCITY_INTERVAL?(u=i.utils.getVelocity(t.timeStamp-n.timeStamp,t.center.pageX-n.center.pageX,t.center.pageY-n.center.pageY),this.current.lastVEvent=t,u.x>0&&u.y>0&&(this.current.velocity=u)):!1===this.current.velocity&&(u=i.utils.getVelocity(s,a,c),this.current.velocity=u,this.current.lastVEvent=t),"end"===t.eventType?(r=this.current.lastEvent&&this.current.lastEvent.interimAngle,o=this.current.lastEvent&&this.current.lastEvent.interimDirection):(r=this.current.lastEvent&&i.utils.getAngle(this.current.lastEvent.center,t.center),o=this.current.lastEvent&&i.utils.getDirection(this.current.lastEvent.center,t.center)),i.utils.extend(t,{deltaTime:s,deltaX:a,deltaY:c,velocityX:u.x,velocityY:u.y,distance:i.utils.getDistance(e.center,t.center),angle:i.utils.getAngle(e.center,t.center),interimAngle:r,direction:i.utils.getDirection(e.center,t.center),interimDirection:o,scale:i.utils.getScale(e.touches,t.touches),rotation:i.utils.getRotation(e.touches,t.touches),startEvent:e}),t},register:function(t){var e=t.defaults||{};return void 0===e[t.name]&&(e[t.name]=!0),i.utils.extend(i.defaults,e,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}},i.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(t,e){if(i.detection.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(e.options.drag_max_touches>0&&t.touches.length>e.options.drag_max_touches))switch(t.eventType){case i.EVENT_START:this.triggered=!1;break;case i.EVENT_MOVE:if(t.distance<e.options.drag_min_distance&&i.detection.current.name!=this.name)return;if(i.detection.current.name!=this.name&&(i.detection.current.name=this.name,e.options.correct_for_drag_min_distance&&t.distance>0)){var n=Math.abs(e.options.drag_min_distance/t.distance);i.detection.current.startEvent.center.pageX+=t.deltaX*n,i.detection.current.startEvent.center.pageY+=t.deltaY*n,t=i.detection.extendEventData(t)}(i.detection.current.lastEvent.drag_locked_to_axis||e.options.drag_lock_to_axis&&e.options.drag_lock_min_distance<=t.distance)&&(t.drag_locked_to_axis=!0);var r=i.detection.current.lastEvent.direction;t.drag_locked_to_axis&&r!==t.direction&&(i.utils.isVertical(r)?t.direction=t.deltaY<0?i.DIRECTION_UP:i.DIRECTION_DOWN:t.direction=t.deltaX<0?i.DIRECTION_LEFT:i.DIRECTION_RIGHT),this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),e.trigger(this.name+t.direction,t),(e.options.drag_block_vertical&&i.utils.isVertical(t.direction)||e.options.drag_block_horizontal&&!i.utils.isVertical(t.direction))&&t.preventDefault();break;case i.EVENT_END:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},i.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(t,e){switch(t.eventType){case i.EVENT_START:clearTimeout(this.timer),i.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==i.detection.current.name&&e.trigger("hold",t)},e.options.hold_timeout);break;case i.EVENT_MOVE:t.distance>e.options.hold_threshold&&clearTimeout(this.timer);break;case i.EVENT_END:clearTimeout(this.timer)}}},i.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==i.EVENT_END&&e.trigger(this.name,t)}},i.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(t,e){if(t.eventType==i.EVENT_END){if(e.options.swipe_max_touches>0&&t.touches.length<e.options.swipe_min_touches&&t.touches.length>e.options.swipe_max_touches)return;(t.velocityX>e.options.swipe_velocity||t.velocityY>e.options.swipe_velocity)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},i.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(t,e){if(t.eventType!=i.EVENT_MOVE||i.detection.current.reachedTapMaxDistance){if(t.eventType==i.EVENT_END&&"touchcancel"!=t.srcEvent.type){var n=i.detection.previous,r=!1;if(i.detection.current.reachedTapMaxDistance||t.deltaTime>e.options.tap_max_touchtime)return;n&&"tap"==n.name&&t.timeStamp-n.lastEvent.timeStamp<e.options.doubletap_interval&&t.distance<e.options.doubletap_distance&&(e.trigger("doubletap",t),r=!0),r&&!e.options.tap_always||(i.detection.current.name="tap",e.trigger(i.detection.current.name,t))}}else i.detection.current.reachedTapMaxDistance=t.distance>e.options.tap_max_distance}},i.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(t,e){e.options.prevent_mouseevents&&t.pointerType==i.POINTER_MOUSE?t.stopDetect():(e.options.prevent_default&&t.preventDefault(),t.eventType==i.EVENT_START&&e.trigger(this.name,t))}},i.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(t,e){if(i.detection.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(t.touches.length<2))switch(e.options.transform_always_block&&t.preventDefault(),t.eventType){case i.EVENT_START:this.triggered=!1;break;case i.EVENT_MOVE:var n=Math.abs(1-t.scale),r=Math.abs(t.rotation);if(n<e.options.transform_min_scale&&r<e.options.transform_min_rotation)return;i.detection.current.name=this.name,this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),r>e.options.transform_min_rotation&&e.trigger("rotate",t),n>e.options.transform_min_scale&&(e.trigger("pinch",t),e.trigger("pinch"+(t.scale<1?"in":"out"),t));break;case i.EVENT_END:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},"function"==typeof define&&define.amd?define(function(){return i}):"object"==typeof e&&e.exports?e.exports=i:t.Hammer=i}(window)},{}],19:[function(t,e,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,i,a,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(s(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),c=1;c<i;c++)a[c-1]=arguments[c];n.apply(this,a)}else if(o(n)){for(i=arguments.length,a=new Array(i-1),c=1;c<i;c++)a[c-1]=arguments[c];for(i=(u=n.slice()).length,c=0;c<i;c++)u[c].apply(this,a)}return!0},i.prototype.addListener=function(t,e){var n;if(!r(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned)&&((n=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()));return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var n,i,s,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,i=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.listenerCount=function(t,e){return t._events&&t._events[e]?r(t._events[e])?1:t._events[e].length:0}},{}]},{},[13]);